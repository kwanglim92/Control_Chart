# 고정 경로 파일 자동 로딩 사용 가이드

## 개요
`streamlit_app` 폴더에 `data.xlsx` 파일을 생성하면 자동으로 데이터를 로드합니다.

## 워크플로우

```
1. 장비 출고
   ↓
2. data.xlsx 파일에 한 줄 추가 (Excel에서 편집)
   ↓
3. 웹사이트 새로고침 (F5)
   ↓
4. 그래프 자동 업데이트! ✅
```

## 사용 방법

### 1. data.xlsx 파일 생성
`streamlit_app` 폴더에 `data.xlsx` 파일을 생성하고 다음 컬럼을 포함해야 합니다:

**필수 컬럼:**
- `Value` - 측정값 (숫자)
- `종료일` - 측정 날짜 (날짜 형식: YYYY-MM-DD)
- `Check Items` - 측정 항목

**선택 컬럼 (필터용):**
- `R/I`
- `Model`
- `XY Scanner`
- `Head Type`
- `MOD/VIT`
- `Sliding Stage`
- `Sample Chuck`
- `AE`
- `장비명` (툴팁 표시용)

### 2. 데이터 추가
- Excel에서 `data.xlsx` 파일을 열어 새로운 행을 추가합니다.
- 파일을 저장합니다.

### 3. 새로고침
- 브라우저에서 **F5**를 누르거나 새로고침 버튼을 클릭합니다.
- 자동으로 최신 데이터가 로드되어 그래프가 업데이트됩니다!

## 동작 원리

1. **자동 감지**: 앱이 시작될 때 `data.xlsx` 파일의 존재 여부를 확인
2. **변경 감지**: 파일의 수정 시간(mtime)을 추적하여 변경 감지
3. **자동 로드**: F5 새로고침 시 파일이 변경되었으면 자동으로 다시 로드
4. **폴백**: `data.xlsx`가 없으면 기존 파일 업로더 표시

## 예제 데이터 구조

| 종료일 | 장비명 | Check Items | Value | R/I | Model |
|--------|--------|-------------|-------|-----|-------|
| 2024-01-15 | EQ-001 | Vibration X | 12.5 | Production | ModelA |
| 2024-01-16 | EQ-002 | Vibration X | 13.2 | R&D | ModelB |
| 2024-01-17 | EQ-001 | Vibration Y | 11.8 | Production | ModelA |

## 주의사항

- Excel에서 파일을 열어 편집 중일 때는 Streamlit이 파일을 읽을 수 없습니다.
- 파일 저장 후 새로고침하세요.
- 파일 형식은 `.xlsx`만 지원합니다.

## 문제 해결

### "data.xlsx 파일을 찾을 수 없습니다" 메시지가 표시됨
→ `streamlit_app` 폴더에 `data.xlsx` 파일이 있는지 확인하세요.

### 데이터를 추가했는데 업데이트가 안 됨
→ Excel에서 파일을 저장했는지 확인하고 F5를 눌러 새로고침하세요.

### "유효하지 않은 Value" 오류
→ `Value` 컬럼에 숫자가 아닌 값이 있는지 확인하세요.
